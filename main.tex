\documentclass{article}

%\usepackage[affil-it]{authblk}
%\usepackage{lineno}
%\usepackage{soul}
%\usepackage{color}
%\usepackage[utf8]{inputenc}
%\usepackage[square,numbers,sort&compress]{natbib}

\title{Accuracy, Stability, and Efficiency of Lattice Boltzmann Models in Simulating Non-Newtonian Flow}
%\title{A Comparison of Lattice Boltzmann Method Collision Operators for Accuracy, Stability and Efficiency in Simulating Non-Newtonian Flows}

\author{{Matthew Grasinger}
\thanks{Email: \textit{grasingerm@pitt.edu}}}

\author{{Scott Overacker}
	\thanks{Email: \textit{sdo10@pitt.edu}}}

\author{John Brigham
\thanks{Email: \textit{brigham@pitt.edu}}}
\affil{Civil and Environmental Engineering Department, University of Pittsburgh}

\begin{document}

\pagenumbering{gobble}
\maketitle
\newpage
\tableofcontents
\newpage
\pagenumbering{arabic}

\linenumbers

Note: anything in {\color{red}red} is just random garbage notes.
You can ignore it for the most part.

\section*{Abstract}

The Lattice Boltzmann method (LBM) is a computational method that can be used for simulating fluid flow.
It is well-suited for complex flows such as non-Newtonian, free surface, and multiphase multicomponent flows.
Non-Newtonian flows are the primary focus of this paper, as many practical engineering problems such as the flow of cement slurries and concretes, the filling of molds by molten metals and plastics, blood flows, etc., are best modeled as non-Newtonian fluids.
LBM is a statistical mechanical approach for simulating fluid flow.
Each time step consists of streaming particle distributions to neighboring nodes, and collisions of particle distributions at each node through a collision operator.
The collision operator is of interest because it has a lot of control over the physics that are simulated, e.g. constitutive laws, interfacial dynamics, etc., and it has implications on numerical stability and computational efficiency.
In this paper, various collision operators and methods for stability enhancement will be examined for their suitability for simulating non-Newtonian flows in terms of accuracy, numerical stability and computational efficiency.
The structure of the paper will be as follows: blah, blah, blah.

\section{Introduction} %MG: this intro will potentially be long. Should it be broken up into subsections (as it is now)?

\subsection{Applications of Non-Newtonian Flow}

The dynamic viscosity of a fluid is a measure of its resistance to shear deformation.
For many fluids, at a constant temperature, the dynamic viscosity can be considered as constant.
These fluids are known as Newtonian fluids.
Non-Newtonian fluids have an apparent dynamic viscosity, or apparent resistance to shear stress, that is variable--even at a constant temperature--and is often a function of strain-rate.
There are a number of fluids in science and engineering applications that can be classified as non-Newtonian; pastes, slurries, molten plastics, polymer solutions, dyes, varnishes, suspensions, and some biomedical liquids such as blood all behave in a non-Newtonian manner \cite{bohme1987non}.
Of all of the different non-Newtonian behaviors that exist, there are two models under which much of the behaviors may be idealized:
\begin{enumerate}
	\item \emph{Yield stress fluids}. Yield stress fluids, also known as Bingham plastics, do not flow until a threshold value of stress, referred to as its yield stress, is exceeded.
	Some examples of yield stress fluids are drilling muds, fresh cement slurries and concretes, and melted metal alloys \cite{ginzburg2002free}.
	Understanding the flow of cement slurries and concretes is important because they are used in the cementing of oil and gas wellbores, and in construction.
	If the cement job for an oil and gas wellbore is not completed successfully then gases and fluids can leak through the wellbore to contaminate ground water or the atmosphere.
	The goal of understanding cement slurry and concrete flows during construction is to understand how construction forms can be completely filled as voids can lead to structural deficiencies~\cite{definitely cite someone}.
	Yield stress flow is relevant in many other disciplines and applications because of the many substances that exhibit yield stress behavior, e.g. pastes, paints, muds, molten plastics and metals, and blood \cite{wang2011lattice}. %MG: citation is for blood as non-Newtonian
	As a consequence, simulating yield stress fluids can help engineers develop better pastes and paints, understand the flow and deformation of mud and clay in geotechnical engineering, understand blood circulation, and better manufacture metal and plastic parts.
	
	\item \emph{Power-law fluids}. Power-law behavior is more commonly known as \emph{shear-thinning}--when the apparent viscosity decreases with increasing strain-rate--or \emph{shear-thickening}--when the apparent viscosity increases with increasing strain-rate. Shear-thinning fluids are also known as \emph{pseudoplastics}, and some examples include polymer mixes and molten plastics.
	Shear-thickening fluids are also known as \emph{dilatants}, and some examples include quicksand, a cornstarch and water mixture, and a silica and polyethylene glycol mixture.
\end{enumerate} %MG: should HB, K-L, Casson, Carreau, and other models be mentioned?

Developing numerical methods for approximating these non-Newtonian flows is important because of how difficult, and often impossible, it is to derive analytical, closed-form solutions.

\subsection{Lattice Boltzmann Method for non-Newtonian Flow} %MG: should this be broken down into subsubsections? Maybe like 'Motivation', 'Stability', 'Recent Developments to Address Stability'

Analytical solutions rarely exists for even the simplest non-Newtonian flows because of the complexity that a non-linear constitutive relationship entails.
It is generally more practical to approximate non-Newtonian flows using numerical methods.
However, the non-linear constitutive equation--typically of the form $\tau = \mu_{app}(\dot{\gamma}) \dot{\gamma}$, where the apparent viscosity, $\mu_{app}$ is a function of the strain rate--results in certain challenges for numerical methods as well.
%Constitutive form for generalized Newtonian fluids, $\tau = \mu(\dot{\gamma}) \dot{\gamma}$, where the apparent viscosity, $\mu$ is a function of the strain rate
Determining the apparent viscosity and shear rate of a flow will often require an iterative solution, a general Picard-type algorithm is:

\begin{enumerate}
	\item Start with initial guess for the apparent viscosity, $\mu_k = \mu_0$.
	\item \label{step:solve-for-flow} Solve for the flow using the current value of apparent viscosity, $\dot{\gamma}_k = \tau_k / \mu_k$.
	\item Update the apparent viscosity, $\mu_{k+1} = \mu(\dot{\gamma}_k)$.
	\item Return to Step \ref{step:solve-for-flow} until convergence is met.
\end{enumerate}

Numerical solutions work by discretizing the equations that govern the physics of interest.
When the solution for fluid flow problems vary in space and time, a numerical approximation requires breaking the problem up into discrete locations and discrete time steps.
The significance of approximating a solution by discretizing the governing equations is that the iterative solution for the constitutive equation must be solved at each discrete location for each discrete time step, which becomes computationally expensive.
The lattice Boltzmann method (LBM) is a numerical method for fluid flow that has the advantage that computing the strain rate is second-order accurate and local to each node~\cite{kruger2010second}.
This means that although an iterative solution is still required to determine the local strain rate and apparent viscosity, each iterative solution can be done in parallel, by a separate process, as they are independent of each other.
Because hardware architectures have shifted from single, sequential processing systems to parallel processing systems, the local nature of the stress--strain-rate relationship in LBM gives it a distinct advantage for simulating non-Newtonian flows over other numerical methods.

The lattice Boltzmann method has been studied and successively applied to modeling various non-Newtonian flows.
~\citet{tang2011bingham,chai2011multiple,fallah2012multiple,chen2014simulations,vikhansky2008lattice,wang2008lattice} developed LBM models for simulating yield stress flows.
The LBM model results agreed well when compared to analytical solutions for Bingham plastic Poiseuille flow, and values from literature for lid-driven cavity flows--showing the feasibility of using LBM models for yield-stress flows.
LBM models for power-law fluid flows~\cite{wang2011lattice,wang2015localized,boyd2006second,chai2011multiple}, and blood flows using the K-L, Casson, and Carreau-Yasuda constitutive relationships~\cite{ashrafizaadeh2009comparison}, have also been successfully developed and verified.

%MG: probably include a discussion of the work done by Conrad et. al. 2015 here
LBM does however, have its drawbacks.
LBM can be considered as a type of finite-difference scheme for the continuous Boltzmann equation, and as such, has numerical properties in common with finite-difference schemes. %MG: is this precise enough? accurate enough?
One such consideration associated with this view, is the potential for numerical inaccuracies and instabilities ~\cite{sterling1993stability,sterling1996stability,bawazeer2013stability,lallemand2000theory}. %MG: are all relevant sources cited?
%Much work has been done to investigate and develop ways to enhance the stability of lattice Boltzmann methods.
Stability concerns are just as prevalent, if not more prevalent, in simulating non-Newtonian flows because the strong nonlinear relationship between shear stress and strain-rate can lead to high non-equilibrium fluctuations. %MG: be more precise than 'fluctuations'?
Various schemes and strategies for incorporating the physics of non-Newtonian flows and yet maintaining a stable numerical method have been developed and studied.
The simplest approach for simulating a shear-rate dependent viscosity, used in~\cite{boyd2006second,chen2014simulations,fallah2012multiple,tang2011bingham,svec2011flow,svec2012free}, is to make the relaxation time--which is proportional to apparent viscosity--variable and dependent on the local strain rate.
A potential issue with the stability of the variable relaxation time approach is that as the relaxation time, $\tau$, approaches $1/2$ the viscosity approaches zero; and alternatively, if the relaxation time is much greater than one, the accuracy and stability of the method also degrades~\cite{latt2007hydrodynamic}.
In order to ensure that the variable relaxation times did not approach values leading to numerical instabilities,~\cite{svec2011flow,svec2012free,gabbanelli2005lattice} set upper and lower bounds on allowable relaxation times.
Although bounding the relaxation time was shown to be effective in terms of stability, it is also nonphysical and can lead to approximations that are inaccurate, not because of round-off error or numerical instability, but because the relaxation time does not reflect the proper constitutive relationship of interest.
Another scheme for incorporating non-Newtonian effects into LBM is to use a constant relaxation rate, typically unity, and to instead incorporate the local shear-rate effect into equilibrium distribution functions.
This means particle distribution functions will always relax toward equilibrium at the same rate, but that the definition of equilibrium is modified to represent the correct stress--strain-rate relationship.
The equilibrium distribution function is derived for the specific constitutive relationship of interest using the Chapman-Enskog multiscale expansion.
The equilibrium distribution function for Bingham plastic flow was derived, implemented, and verified in~\cite{wang2008lattice}; and the equilibrium distribution functions for power-law fluids and Carreau fluids were derived, implemented, and verified in~\cite{yoshino2007numerical}.
The strategy of using an equilibrium distribution function that incorporates the local shear-rate effect has the advantage that, because the relaxation time is constant (at unity), the local relaxation time will not approach values that are too small or too large, and so there is no reason to bound the relaxation time in a way that is nonphysical.
\citet{wang2011lattice} developed another constant-relaxation time LBM scheme for non-Newtonian flows by splitting the effects of constitutive relationship into Newtonian and non-Newtonian parts--for example, considering the plastic viscosity and yield stress for a Bingham plastic separately--then incorporating the Newtonian part in the usual way, namely scaling the relaxation time to achieve the macroscopic (Newtonian) viscosity, and incorporating the non-Newtonian part as a source of momentum, i.e. as an external forcing term, that is dependent on local shear-rate.
Although the constant-relaxation time strategies present interesting alternatives, the variable relaxation time scheme is used in the present study because of its simplicity and flexibility. %MG: should we define what we mean by 'flexibility'?

Much work has been done (not specific to non-Newtonian flows) to investigate and develop ways to enhance the stability of lattice Boltzmann methods.
\citet{sterling1993stability,sterling1996stability} investigated the stability of LBM with the linear Bhatnagar--Gross--Krook (BGK) collision operator on 7-velocity and 9-velocity 2D lattices and a 15-velocity cubic lattice.
The investigation was performed by linearizing all nonlinear terms about global equilibrium values and applying a von Neumann stability analysis on the resulting linearized equations.
The spatial dependence of stability was analyzed by taking the Fourier transform of the linearized equations.
\citeauthor{sterling1993stability} concluded that the linear stability of LBM models depends on the mass distribution parameters, the mean velocity, the relaxation time, and the wave number. %MG: this probably requires some clarification and a more concrete tieback to the highlevel goals of this paper
%(Some misc notes from this study that probably don't fit here but are important to this work: ``... a Courant stability condition is superceded by a more stringent stability condition on the speeds. Another stability boundary common for finite-difference methods requires that the viscous diffusion speed be less than the lattice spacing divided by the time step. This boundary is not observed for LB methods because as the viscosity increases, errors of the scheme increase due to the presence of large nonequilibirum populations, but stability is still maintained''??).
~\citet{worthing1997stability} extended the stability analysis performed by \citeauthor{sterling1993stability}, and instead of linearizing the LBM equations by expanding about global equilibrium values, \citeauthor{worthing1997stability} \ul{does something else}.
Their analysis discover both physical and nonphysical instabilities, and that setting the BGK relaxation time, $\tau = 1$ provides the optimal accuracy in time. %MG: is this actually relevant though?
\ul{Expand a little more about what they did and its significance here.}
%MG: all this stability talk is nice, but I need to figure out how to tie it back to non-Newtonian flows sooner rather than later. The problem is a lot of these studies focus on instability due to high Reynolds number flows, not really our problem. We're more concerned with instability due to higher relaxation rates and apparent viscosities. And how does MRT address this instability?

Although much work has been done to characterize the stability of LBM models, these analyses have the following limitations to their applicability:
\begin{itemize}
	\item von Neumann stability analysis, and linear stability analysis in general requires modifying the governing equations of the model so that they are linear. %MG: is there even a distinction between von Neumann stability analysis and linear stability analysis?
	This linearization cannot be done without introducing some error into the analysis.
	\item Much of the analysis that exists in literature is done about a uniform flow~\cite{worthing1997stability,niu2004investigation}. %MG: definitely cite and/or verify this more
	\item Analyses are most often carried out assuming periodic boundary conditions.
	Periodic boundary conditions are advantageous for stability analysis because the analysis is generally done by a Fourier analysis on the propagation of error.
	The periodicity of Fourier modes allows the periodic boundary conditions to automatically be satisfied.
	Such an analysis, however, does not generalize well to instances when modes of the system are heavily influenced by the boundary conditions~\cite{worthing1997stability}. %MG: so many questions: like what is an example of an instance when boundary conditions have a major effect and when are they more ``negligible'' or more like periodic BCs?
	\item The analyses are general and do not delve into any of the nuances of non-Newtonian flows.
\end{itemize}
{\color{red} Bawazeer wrote a thesis on the stability and accuracy of the lattice Boltzmann method. Perhaps I'll read it. I think Jonas Latt did too.}

To improve upon the stability of LBM models, \citet{d1994generalized} developed a multiple-relaxation-time (MRT) collision operator, that takes place in moment space and allows each moment to relax at a different rate.
\citet{lallemand2000theory} used von Neumann stability analysis to investigate the dispersion, dissipation, isotropy, Galilean invariance, and stability of the newly constructed LBM-MRT model.
They concluded LBM with the MRT collision operator was more stable, but with increased computational expense, than what is still often used, the BGK collision operator.
Note that although this increased computational expense was decided to be not too significant for Newtonian flows ($\approx$ 10-20\% \cite{lallemand2000theory}), the issue may be magnified for non-Newtonian flows because an iterative solution for the constitutive equation can require that certain aspects of the collision operator be performed at each iteration (the strain rate tensor is determined from the non-equilibrium distribution function which must be mapped into momentum space when using the MRT collision operator).
Both the BGK~\cite{wang2011lattice,ashrafizaadeh2009comparison,wang2015localized,tang2011bingham} and MRT~\cite{chen2014simulations,fallah2012multiple,chai2011multiple} collision operators have been used successfully to simulate non-Newtonian flows.
\citeauthor{chen2014simulations} concluded that the MRT collision operator was more stable for Bingham plastic flow and allowed the use of a more accurate approximation to the Bingham plastic constitutive relationship.

{\color{red} 
ELBM and entropic filtering stuff goes here.
The price of entropic lattice Boltzmann models for fluid flow is living with a bounded transport coefficient.
Entropically stabilized collision operators ensure that entropy always increases, i.e. that the second law of thermodynamics is never violated.
For BGK, this means that the relaxation time is bounded from below in certain instances~\cite{boghosian2001entropic}.
``it may be argued that we are relinquishing some control over the transport coefficients'' and ``of course, making $\tau$ a nontrivial function of the incoming state will impact the hydrodynamic equations derived from the model''~\cite{boghosian2001entropic}.
``stability is guaranteed''?
Define Lyapunov functional or Lyapunov stability condition.
}

The goal of this paper is to numerically study the implications of accuracy, stability, and efficiency for some of the different strategies for simulating non-Newtonian flows using LBM. The intention of the study is to aid scientists and engineers in understanding which strategy to choose given their priorities and applications of interest so as to maximize the advantages LBM has in simulating non-Newtonian flow.
Advantages, such as LBM's potential to scale well in parallel, can be much less realized if the collision operator is too computationally expensive, or if numerical instabilities ensue.
A numerical study can help to determine approximate numerical values, domains, and boundary conditions in which one LBM scheme may be more advantageous than another so that LBM may be used in a computationally efficient and stable manner.

\section{Lattice Boltzmann Method}

\subsection{Overview}

Some overview of Lattice Boltzmann Method stuff~\cite{grasinger2015simulation}.

\subsection{The Boltzmann Equation}

\subsection{Boundary Conditions}

\subsection{Applied Forces}

\subsection{Collision Operator} %MG: if time allows, checkout differential lattice Bolzmann equation, the interpolation-supplemented lattice Boltzmann method, and the Taylor series expansion- and least square-based lattice Boltzmann method; Niu et. al. 2004

\subsubsection{Bhatnagar--Gross--Krook}

\subsubsection{Multiple Relaxation Time}

\subsubsection{Entropic Collisions and Entropy Balance}

\section{Stability Analysis}

\subsection{von Neumann Stability Analysis}

\subsection{Matrix Method of Stability Analysis}

\subsection{Other Possible Approaches}

\section{Numerical Study}
Two different flow simulations, Poiseuille flow and lid-driven flow, and two different non-Newtonian behaviors, yield stress fluids and power-law fluids,  served as the basis for the numerical study comparing LBM for non-Newtonian fluid flow simulation.  
Within these physical models and constitutive relationships, multiple parameters were evaluated.
\subsection{Poiseuille Flow} 
Computational Efficiency

Numerical Stability
\subsection{Lid-driven Flow}
In the simulations, a constant velocity of $u_0$ was fixed at 0.1 across the lid. 
No slip boundary conditions were fixed to the remaining walls of the cavity.
To validate the model used for the comparison, the results had to be compared with results from [...,...,...]. 
As shown in the table (show table of our vortex centers compared with other papers), it can be seen that the results of the present simulations match the benchmark results well.
The previous results of [...] showed grid independence between 256x256 grids and 512x512 grids, and it was found that stability or accuracy were not markedly enhanced between a 256x256 grid and a 100x100 grid for material properties evaluated in these tests. 
For computational efficiency, subsequent tests were performed on a 100x100 grid.


For the yield stress lid-driven cavity flow, Bingham numbers of 1, 10, and 100 for Reynolds numbers of 100, 1000, 5000, and 10000 were used for the simulations that varied the stress growth parameter, $m$, and utilized either entropic filtering, placing bounds of 0.501 and 8.0 on the relaxation time, or no stability enhancement strategies. %SDO-What are the units here, seconds?  
Stability enhancements were used on both the BGK and MRT collision operators.
For all tests, more stable and efficient results were found when the flow was closer to laminar Newtonian flow behavior. 
Additionally, with these fluid properties the effect of the stress growth parameter and any stability enhancement was negligible in terms of stability or accuracy.  
All collision operators with or without stability enhancements yielded very similar streamlines, stream functions, and locations and strengths of the primary vortex.
However, computational time between the tests varied widely, with the tests using a stress growth exponent of $10^8$ taking about 10\% longer than the tests with a stress growth exponent of $10^5$.  
Bounding the relaxation time actually increased the computational time by about 5\% and using entropic filtering with the BGK operator decreased computational time by nearly 18\%.
Finally, using the MRT operator with or without entropic filtering decreased the computational efficiency by about 300\%.

As the Reynolds number and Bingham numbers increased when plastic viscosity was decreased and yield stress was increased, respectively, it was seen that the stability of flow models conducted with the BGK operator lost stability and accuracy while maintaining computational efficiency.
With $Re \geq 5000$, the tests using the standard BGK operator and the BGK operator with bounds on the relaxation time were unstable to the point that the solution was divergent, regardless of the Bingham number.  
Entropic filtering stabilized the BGK collision operator tests effectively, yielding streamlines and a stream function that was mimicked the results of the tests using the MRT operator and previous results [...] well. %SDO-Good place to show a figure.
However, as the Reynolds and Bingham numbers increased, the location and strength of the entropic-filtered BGK operator primary vortex deviated from that determined with the MRT operator, and the smoothness of the stream function of the MRT operator was lost. %SDO-Another good place for a picture, maybe a table showing the locations and strengths of the central vortices.
As has been found in previous studies [...,...], the multiple-relaxation time operator markedly increased stability and computational inefficiency. 
With the relatively coarse grid used for this study, the results never became unstable and the efficiency was about a third of that of the BGK operator. 
For finer grids the margin increased further, and the MRT operator required substantially more iterations to reach a steady-state solution (actually a steady state condition was never met for any MRT test).


Computational Efficiency/Time

Numerical Stability

Effect of entropic filtering

Effect of m (stress growth exponent)

\section{Conclusion}

\section*{Acknowledgements}

\bibliographystyle{abbrvnat}
\bibliography{master}
	
\end{document}
